<!DOCTYPE html><html><head>    <meta charset="utf-8">    <script type="text/javascript" src="http://g.tbcdn.cn/sj/lib/jquery/dist/jquery.min.js"></script>    <script src="http://cdn.static.runoob.com/libs/angular.js/1.4.6/angular.min.js"></script>    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/4.0.0/echarts.js"></script>    <script>        var app = angular.module('demo', []); //定义一个模块        angular.module('demo').controller("myCtrl", function($scope, $http, $interval) { //定义控制器            // $interval(function() { //调用$interval服务执行循环任务，3秒自动更新一次数据            //     $http.get("/demo_get") //调用$http服务获取数据            //         .success(function(data) {            //             if (data.status == '0') {            //                 $scope.data = data.data; //将数据放在model中            //             }            //         }).error(function() {            //         $scope.data[0].value = Math.floor(Math.random() * 2000); //模拟数据改变测试            //     });            // }, 3000);            //假设获取到的数据如下：            // var fakeData = {            //     'status': 0,            //     'data': [{            //         'value': 335,            //         'name': '直接访问'            //     }, {            //         'value': 310,            //         'name': '邮件营销'            //     }, {            //         'value': 234,            //         'name': '联盟广告'            //     }, {            //         'value': 135,            //         'name': '视频广告'            //     }, {            //         'value': 748,            //         'name': '搜索引擎'            //     }]            // };            // $scope.data = fakeData.data;        });        angular.module('demo').directive('graphChart', function($window) { //定义流程图            var data=null;            console.log(data||'');            return {                restrict: 'A',                link: function($scope, element, attrs) { //attrs是DOM元素的属性集合                    var myChart = echarts.init(element[0]);                    $scope.$watch(attrs.eData, function(newValue, oldValue, scope) {                        var allData = [{                            id: 1,                            state: 'finished',                            target: [2]                        },{                            id: 2,                            state: 'finished',                            target: [3]                        },{                            id: 3,                            state: 'process',                            target: [4]                        },{                            id: 4,                            state: 'process',                            target: [5]                        },{                            id: 5,                            state: 'wait',                            target: null                        }];                        var data1 = allData.map((item,index)=>{                            return {                                name: item.id.toString(),                                value:'22',                                // itemStyle:{                                //     color: '#c23531',                                // },                                x:Math.floor((index+1) * 200),                                y:300                            }                        });                        var allLink=[];                        var link = allData.map((item)=>{                            if(item.target !== null){                                item.target.map((v)=>{                                    allLink.push({                                        source: item.id.toString(),                                        target: v.toString(),                                        lineStyle: {                                            normal: {                                                color: '#c23531',                                                width: 1,                                                curveness: 0.5                                            }                                        }                                    })                                })                            }                        });                        console.log(allLink);                        var option = {                            tooltip: {},                            color: [                                '#1890ff'                            ],                            layout:'force',                            animationDurationUpdate: 1500,                            animationEasingUpdate: 'quinticInOut',                            series : [                                {                                    type: 'graph',                                    layout: 'none',                                    symbolSize: 20,                                    roam: true,                                    label: {                                        normal: {                                            show:true,                                            position: 'right',                                            formatter: '{b}'                                        }                                    },                                    edgeSymbol: ['circle', 'arrow'],                                    edgeSymbolSize: [4, 10],                                    edgeLabel:{                                        show: false,                                    },                                    // edgeLabel: {                                    //     normal: {                                    //         textStyle: {                                    //             fontSize: 10                                    //         }                                    //     }                                    // },                                    data:data1,                                    // data: [{                                    //     name: '节点1',                                    //     x: 300,                                    //     y: 300                                    // }, {                                    //     name: '节点2',                                    //     x: 800,                                    //     y: 300                                    // }, {                                    //     name: '节点3',                                    //     x: 550,                                    //     y: 100                                    // }, {                                    //     name: '节点4',                                    //     x: 550,                                    //     y: 500                                    // }],                                    links:allLink,                                    // links: [{                                    //     source: '节点1',                                    //     target: '节点2',                                    //     symbolSize: [5, 20],                                    //     label: {                                    //         normal: {                                    //             show: true                                    //         }                                    //     },                                    //     lineStyle: {                                    //         normal: {                                    //             width: 5,                                    //             curveness: 0.2                                    //         }                                    //     }                                    // }, {                                    //     source: '节点2',                                    //     target: '节点1',                                    //     label: {                                    //         normal: {                                    //             show: true                                    //         }                                    //     },                                    //     lineStyle: {                                    //         normal: { curveness: 0.2 }                                    //     }                                    // }, {                                    //     source: '节点1',                                    //     target: '节点3'                                    // }, {                                    //     source: '节点2',                                    //     target: '节点3'                                    // }, {                                    //     source: '节点2',                                    //     target: '节点4'                                    // }, {                                    //     source: '节点1',                                    //     target: '节点4'                                    // }],                                    lineStyle: {                                        normal: {                                            opacity: 0.9,                                            width: 2,                                            curveness: 0                                        }                                    }                                }                            ]                        };                        myChart.setOption(option);                    }, true);                    $window.onresize = function() { //调用window服务，使图表能响应式调整大小                        myChart.resize();                    };                }            };        });    </script></head><body><div ng-app="demo" ng-controller="myCtrl" id="demo">    <div style="width: 600px;height:400px;" graph-chart e-data="data"></div></div></body></html>